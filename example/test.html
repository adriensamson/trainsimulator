<!DOCTYPE html>
<html>
    <head>
        <title>Train simulator</title>
        <script type="text/javascript" src="../src/trainsimulator.js"></script>
        <script type="text/javascript" src="../src/trainsimulatorui.js"></script>
    </head>
    <body>
        <h1>Train simulator TEST</h1>
        <canvas id="canvas" width="300" height="300"></canvas>
        <script type="text/javascript">
var tsui = new TrainSimulatorUi(document.getElementById('canvas'));

var track1 = tsui.newStraightTrack({x: 50, y:50 }, 0);
var track2 = tsui.newCurveTrack({x: 200, y:100 }, 50, -Math.PI / 2, false);
var track3 = tsui.newStraightTrack({x: 200, y:150 }, Math.PI);
var track4 = tsui.newCurveTrack({x: 50, y:100 }, 50, Math.PI / 2, false);
var track5 = tsui.newCurveTrack({x: 150, y:100 }, 50, -Math.PI / 2, false);

var joint1_2 = tsui.newJoint();
joint1_2.connectTrack(1, track1, 150, 1);
joint1_2.connectTrack(2, track2, 0, -1);

var joint2_3 = tsui.newJoint();
joint2_3.connectTrack(1, track2, 50 * Math.PI, 1);
joint2_3.connectTrack(2, track3, 0, -1);

var joint3_4 = tsui.newJoint();
joint3_4.connectTrack(1, track3, 150, 1);
joint3_4.connectTrack(2, track4, 0, -1);

var joint4_1 = tsui.newJoint();
joint4_1.connectTrack(1, track4, 50 * Math.PI, 1);
joint4_1.connectTrack(2, track1, 0, -1);

/*
var joint1_5 = tsui.newJoint();
joint1_5.connectTrack(1, track1, 100, 1);
joint1_5.connectTrack(2, track5, 0, -1);

var joint5_3 = tsui.newJoint();
joint5_3.connectTrack(1, track5, 50 * Math.PI, 1);
joint5_3.connectTrack(2, track3, 50, -1);
*/

var switch1 = tsui.newSwitch();
switch1.connectTrack(1, track1, 100, 1);
switch1.connectTrack(2, track1, 100.001, -1);
switch1.connectTrack(3, track5, 0, -1);

var switch2 = tsui.newSwitch();
switch2.connectTrack(1, track3, 51, -1);
switch2.connectTrack(2, track3, 50.001, 1);
switch2.connectTrack(3, track5, 50 * Math.PI, 1);

var train = tsui.newTrain(20);
train.putOnTrack(track1, 55, 1);

tsui.trainSimulator.sortElements();
tsui.redraw();
tsui.trainSimulator.sortElements();

function move() {
    train.move(1);
    tsui.trainSimulator.sortElements();
    tsui.redraw();
};

var movingInterval = false;
function toggleMove() {
    if (movingInterval) {
        clearInterval(movingInterval);
        movingInterval = false;
    } else {
        movingInterval = setInterval(move, 100);
    }
};

        </script>
        <button type="button" onclick="toggleMove()">GO / STOP</button>
        <button type="button" onclick="switch1.toggle()">Switch 1</button>
    </body>
</html>

