<!DOCTYPE html>
<html>
    <head>
        <title>Train simulator</title>
        <script type="text/javascript" src="../src/trainsimulator.js"></script>
        <script type="text/javascript" src="../src/drawer.js"></script>
        <script type="text/javascript" src="../src/builder.js"></script>
        <script type="text/javascript" src="quad.js"></script>
        <script type="text/javascript" src="../src/automatic.js"></script>
    </head>
    <body>
        <h1>Train simulator TEST</h1>
        <canvas id="canvas" width="800" height="800"></canvas><br />
        <script type="text/javascript">
var schema = {
    points: {
        'origin': {x: 0, y: 0, angle: 0},
        'origin2': {x:0, y: 60, angle: 0},
        'origin3': {x:0, y: 120, angle: 0},
        'origin4': {x:0, y: 180, angle: 0},
        'origin5': {x:0, y: 240, angle: 0}
    },
    'pieces': [].concat(
        
        QuadPieces.straightA0(1, {endPoint: 'a0.1|0'}),
        QuadPieces.sw('a0.1'),
        QuadPieces.changeTrackA0P({startPoint: 'a0.1|2'}),
        QuadPieces.changeTrackA0Pcc(),
        QuadPieces.changeTrackA0N(),
        QuadPieces.changeTrackA0Ncc({endPoint: 'a0.2|2'}),
        QuadPieces.sw('a0.2'),
        QuadPieces.straightA0(4, {startPoint: 'a0.1|1', endPoint: 'a0.2|1'}),
        
        QuadPieces.straightA0(1, {startPoint: 'a0.2|0'}),
        
        QuadPieces.curveA0A1(),
        
        QuadPieces.straightA1(1, {endPoint: 'a1.1|0'}),
        QuadPieces.sw('a1.1'),
        QuadPieces.changeTrackA1P({startPoint: 'a1.1|2'}),
        QuadPieces.changeTrackA1Pcc(),
        QuadPieces.changeTrackA1N(),
        QuadPieces.changeTrackA1Ncc({endPoint: 'a1.2|2'}),
        QuadPieces.sw('a1.2'),
        QuadPieces.straightA1(4, {startPoint: 'a1.1|1', endPoint: 'a1.2|1'}),
        QuadPieces.straightA1(1, {startPoint: 'a1.2|0'}),
        
        QuadPieces.curveA1A0(),
        QuadPieces.straightA0(2),
        QuadPieces.curveA0A2(),
        
        QuadPieces.straightA2(1, {endPoint: 'a2.1|0'}),
        QuadPieces.sw('a2.1'),
        QuadPieces.changeTrackA2P({startPoint: 'a2.1|2'}),
        QuadPieces.changeTrackA2Pcc(),
        QuadPieces.changeTrackA2N(),
        QuadPieces.changeTrackA2Ncc({endPoint: 'a2.2|2'}),
        QuadPieces.sw('a2.2'),
        QuadPieces.straightA2(4, {startPoint: 'a2.1|1', endPoint: 'a2.2|1'}),
        QuadPieces.straightA2(1, {startPoint: 'a2.2|0'}),
        
        QuadPieces.curveA2A0(),
        QuadPieces.straightA0(2),
        QuadPieces.curveA0A3(),
        QuadPieces.straightA1(2),
        QuadPieces.curveA3A0(),
        QuadPieces.straightA0(2),
        QuadPieces.curveA0A4(),
        QuadPieces.straightA0(2),
        QuadPieces.curveA4A0(),
        QuadPieces.straightA0(2),
        
        QuadPieces.straight(0, 2, {startPoint: 'origin2'}),
        QuadPieces.curve(0, 1), QuadPieces.straight(1, 2),
        QuadPieces.curve(1, 2), QuadPieces.straight(2, 2),
        QuadPieces.curve(2, 3), QuadPieces.straight(3, 2),
        QuadPieces.curve(3, 4), QuadPieces.straight(4, 2),
        QuadPieces.curve(4, 5), QuadPieces.straight(5, 2),
        QuadPieces.curve(5, 6), QuadPieces.straight(6, 2),
        QuadPieces.curve(6, 7), QuadPieces.straight(7, 2),
        QuadPieces.curve(7, 8), QuadPieces.straight(8, 2),
        QuadPieces.curve(8, 9), QuadPieces.straight(9, 2),
        QuadPieces.curve(9, 10), QuadPieces.straight(10, 2),
        QuadPieces.curve(10, 11), QuadPieces.straight(11, 2),
        QuadPieces.curve(11, 12), QuadPieces.straight(12, 2),
        QuadPieces.curve(12, 13), QuadPieces.straight(13, 2),
        QuadPieces.curve(13, 14), QuadPieces.straight(14, 2),
        QuadPieces.curve(14, 15), QuadPieces.straight(15, 2),
        QuadPieces.curve(15, 0), QuadPieces.straight(0, 2),
        
        QuadPieces.straight(0, 2, {startPoint: 'origin3'}),
        QuadPieces.curve(0, 2), QuadPieces.straight(2, 2),
        QuadPieces.curve(2, 4), QuadPieces.straight(4, 2),
        QuadPieces.curve(4, 6), QuadPieces.straight(6, 2),
        QuadPieces.curve(6, 8), QuadPieces.straight(8, 2),
        QuadPieces.curve(8, 10), QuadPieces.straight(10, 2),
        QuadPieces.curve(10, 12), QuadPieces.straight(12, 2),
        QuadPieces.curve(12, 14), QuadPieces.straight(14, 2),
        QuadPieces.curve(14, 0), QuadPieces.straight(0, 2),
        
        QuadPieces.curve(0, 1), QuadPieces.straight(1, 2),
        QuadPieces.curve(1, 3), QuadPieces.straight(3, 2),
        QuadPieces.curve(3, 5), QuadPieces.straight(5, 2),
        QuadPieces.curve(5, 7), QuadPieces.straight(7, 2),
        QuadPieces.curve(7, 9), QuadPieces.straight(9, 2),
        QuadPieces.curve(9, 11), QuadPieces.straight(11, 2),
        QuadPieces.curve(11, 13), QuadPieces.straight(13, 2),
        QuadPieces.curve(13, 15), QuadPieces.straight(15, 2),
        QuadPieces.curve(15, 1), QuadPieces.straight(1, 2),
        
        QuadPieces.straight(0, 2, {startPoint: 'origin4'}),
        QuadPieces.curve(0, 3), QuadPieces.straight(3, 2),
        QuadPieces.curve(3, 6), QuadPieces.straight(6, 2),
        QuadPieces.curve(6, 9), QuadPieces.straight(9, 2),
        QuadPieces.curve(9, 12), QuadPieces.straight(12, 2),
        QuadPieces.curve(12, 15), QuadPieces.straight(15, 2),
        QuadPieces.curve(15, 2), QuadPieces.straight(2, 2),
        QuadPieces.curve(2, 5), QuadPieces.straight(5, 2),
        QuadPieces.curve(5, 8), QuadPieces.straight(8, 2),
        QuadPieces.curve(8, 11), QuadPieces.straight(11, 2),
        QuadPieces.curve(11, 14), QuadPieces.straight(14, 2),
        QuadPieces.curve(14, 1), QuadPieces.straight(1, 2),
        QuadPieces.curve(1, 4), QuadPieces.straight(4, 2),
        QuadPieces.curve(4, 7), QuadPieces.straight(7, 2),
        QuadPieces.curve(7, 10), QuadPieces.straight(10, 2),
        QuadPieces.curve(10, 13), QuadPieces.straight(13, 2),
        QuadPieces.curve(13, 0), QuadPieces.straight(0, 2),
        
        QuadPieces.straight(0, 2, {startPoint: 'origin5'}),
        QuadPieces.curve(0, 4), QuadPieces.straight(4, 2),
        QuadPieces.curve(4, 8), QuadPieces.straight(8, 2),
        QuadPieces.curve(8, 12), QuadPieces.straight(12, 2),
        QuadPieces.curve(12, 0), QuadPieces.straight(0, 2),
        
        QuadPieces.curve(0, 1), QuadPieces.straight(1, 2),
        QuadPieces.curve(1, 5), QuadPieces.straight(5, 2),
        QuadPieces.curve(5, 9), QuadPieces.straight(9, 2),
        QuadPieces.curve(9, 13), QuadPieces.straight(13, 2),
        QuadPieces.curve(13, 1), QuadPieces.straight(1, 2),
        
        QuadPieces.curve(1, 2), QuadPieces.straight(2, 2),
        QuadPieces.curve(2, 6), QuadPieces.straight(6, 2),
        QuadPieces.curve(6, 10), QuadPieces.straight(10, 2),
        QuadPieces.curve(10, 14), QuadPieces.straight(14, 2),
        QuadPieces.curve(14, 2), QuadPieces.straight(14, 2),
        
        QuadPieces.curve(2, 3), QuadPieces.straight(3, 2),
        QuadPieces.curve(3, 7), QuadPieces.straight(7, 2),
        QuadPieces.curve(7, 11), QuadPieces.straight(11, 2),
        QuadPieces.curve(11, 15), QuadPieces.straight(15, 2),
        QuadPieces.curve(15, 3), QuadPieces.straight(3, 2),
        []
    )
};
var builder = new TrainSimulator.TrainSimulatorBuilder();
var drawer = new TrainSimulator.CanvasDrawer(document.getElementById('canvas'));
var trainSimulator = new TrainSimulator.TrainSimulator();
var ticker = new TrainSimulator.Ticker();
ticker.tickDelta = 0.1;
ticker.registerResolveTickable(trainSimulator);
ticker.registerOutputTickable(drawer);

builder.build(schema);
builder.registerToTrainSimulator(trainSimulator);
builder.registerToDrawer(drawer);
drawer.scale = 1;
drawer.trackWidth = 1.435;
drawer.switchLength = 9;
drawer.gridInfo = {
    minX: 0,
    maxX: 500,
    minY: 0,
    maxY: 500,
    spacing: 15
};
drawer.doGridDrawing = true;

ticker.run();
        </script>
    </body>
</html>

